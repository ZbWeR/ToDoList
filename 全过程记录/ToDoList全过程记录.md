# ToDoList全过程记录

## 设计阶段

### 1.功能设计

(1.18初版)

#### 待办事项的细分

待办事项通常具有不同的场景,需要先进行类型的划分.~~例如一两句话即可说清楚的事项"出门前倒垃圾",再例如文字内容较多的详细事项"回家的路上帮女朋友带一杯黄金真奶要全糖去冰,再带一份手抓饼,要鸡蛋热狗里脊",对于这两种情况,我们将其命名为**短文本**和**长文本**.再~~

例如有的事项可能有一两周的时间去完成,而有的事项需要一两天内完成,我们将这两种情况归纳为**短期待办**和**长期待办**.事项本身可能是与学习相关,与工作相关,根据相关性我们将不同事项分为**生活,学习和工作**三种.

综上，新增待办时我们要让用户明确待办的类型(这决定了待办事项的展示效果)，具体待办内容和待办截止日期(可选).

> 1.19更新删除线部分: 在做 UI 页面设计时,一直做不出想象中短长文本的效果,反而使得页面凌乱,仔细思考应用场景之后觉得这一分类完全是画蛇添足,遂删去.最终决定所有文本都单行显示,文本较长则用省略号断开.点击待办进入详情页则可查看完整内容.

**不同类型展示效果**

| 类型              |                                                    展示效果                                                    |
| ----------------- | :------------------------------------------------------------------------------------------------------------: |
| ~~长文本/短文本~~ | ~~均采用块状盒子的方式显示.<br>短文本显示内容,DDL,长短期类型<br>长文本仅显示内容,最长字数待定,超出字数则隐藏~~ |
| 短期 / 长期       |  1.默认情况:长期短期两个模块分开显示,短期在长期之上<br>2.设置精确DDL时:长期任务在ddl前2天变成短期任务并标红.   |
| 生活/学习/工作    |         颜色色相依次对应:~~黄/绿/蓝(具体颜色取值待定)~~<br>黄:#FEF9D7<br>绿:#b5f291<br>蓝:#d1eeff<br>          |

> 1.19更新颜色具体取值: 参考了 即时设计官网的部分色彩.

#### 待办的增删查改

(1.18初版)

**预期效果**

1. 增加: 点击**新建**(+)启动增加待办模块,用户选择【短期/长期】【生活/学习/工作】,填写具体内容，选填DDL,即可生成待办.
2. 删除/修改: 点击**设置**进入管理模式,所有待办右侧出现**删除和编辑**两个选项,点击删除然后二次确认即可.
3. 查找: 不考虑增加该功能.

**其他想法**

采用类似终端输入的方法,放置一个输入框在整个页面上方,输入不同的指令来完成**增删改**的功能.

1. 增加

   例如`add -s -study -[DDL] content `表示添加一个短期学习待办.`DDL`的格式限制为`year.month.day`.

   其他参数说明:`-s/l`short短期/long长期 ;`-study/life/work`分别对应学习生活工作.

   带有`-`的参数均可选,默认值为 短期生活无DDL 待办.

2. 删除:`del -s/l index`表示删除编号为index的短期/长期待办. 增加待办后会自动给待办事项编号,显示在待办左侧.

3. 修改:`set -s/l index -s/l -study -[DDL] content`表示修改编号为index的短期/长期待办,其他参数与增加时相同.

==最终版本见UI设计模块==

### 2.UI设计

网页端：预期采用Flex布局,移动端表现为上下排列.

![image-20230119220619209](%E6%95%B4%E4%BD%93%E9%A1%B5%E9%9D%A2.png)

最终**增删改查**的实现:==1.19更新== 

+ 直接在输入框中输入待办事项回车,弹窗如下,进行具体设置即可实现增加操作.
+ 对于删除操作,点击待办左侧的小圆圈即可触发删除操作,第一天变为灰色,第二天自动抹去.
+ 对于更改操作,点击待办进入类似与下图弹窗的**待办详情**,即可重新修改.

![image-20230119220808365](%E6%96%B0%E5%BB%BA%E5%BE%85%E5%8A%9E.png)

>第一个方案比较类似于移动端交互,在做UI设计的时候发现没有好看并且合适的icon,并且icon的位置也让我很为难,遂放弃.
>
>第二个方案在做的时候感觉后期js要写的东西比较多,而且这些参数的设置也不是很便于操作,遂放弃.
>
>思考后决定结合两者,保留终端输入,但是舍弃繁琐的参数.具体参数由用户回车后(免除了icon的选择)自己点击来设置.
>
>怎么说呢？体验了一把UI设计倒逼功能设计😎

## 代码阶段

1.19 : 构建网页主体部分(除弹窗基本完成)；待解决问题: 长文本省略与emoji重合，事件增添的过渡效果.

1.20 : 完成功能模块：增加和删除.

遇见的困难如下:

1. 本地持久化存储数据 loaclStorage 的使用以及如何利用其保存 json 数组
2. js 中如何拼接出json数据->需要借助eval方法和反引号.
3. 由于DOM树改变导致按钮绑定的事件失效问题如何解决->通过body绑定.
4. 如何通过点击按钮来获取父元素以达到正确删除的目的-> e.target.parentElement
5. 本地无数据时如何初始化,初始化的json数据长什么样,整个数据库中的json格式又应该是什么样的?
6. 如何导入本地json->利用fetch,但是会产生CORS问题,如何解决->livesever或者部署到服务器.

> 对javaScript的各种API掌握还是不熟练啊啊啊啊啊啊啊,每次都是要用才去翻文档,一路磕磕绊绊.有的东西可能解决后总结起来一两行字,但其实花了我很多时间绕了很多弯路.
>
> 比如在json格式设置这方面,对于每一个待办最开始我是想让它拥有一个index,这样执行删除操作时比较方便,但是这个index的获取和处理在当时想起来又比较麻烦.又是就换了思路,管它什么时间复杂度,直接遍历数据库匹配去删除,这样对于每一个待办只需要有一个唯一标识id就行了,我最开始是想根据待办的内容去进行md5加密,然后以加密后的值为id,但是想想觉得没必要,直接利用加入待办的事件戳为id就好了,还能方便后面ddl功能的处理.

1.21 : 早上在写文档,下午希望能完成弹窗页面的框架和样式,再补充js中LongList的部分.



1. js 中遮罩层的实现：点击遮罩层非内容部分关闭(event.target),阻止事件冒泡(Event.stopPropagation)
